\providecommand{\main}{../../main}
\providecommand{\figpath}[1]{\main/../lessons/#1}
\documentclass[../../main/main.tex]{subfiles}



\begin{document}

\newdate{date}{03}{12}{2020}
\marginpar{ \textbf{Lecture 19.} \\  \displaydate{date}.}

\subsection{Frequency response from transfer function}
If the ROC of the transfer function \( H(z) \) includes the unit circle, then the \textbf{frequency response} \( H(e^{j\omega}) \) of the LTI digital filter can be obtained simply as follows:
\marginpar{Frequency response from transfer function}
\begin{equation}
    H(e^{j\omega})
    =
    \qty[H(z)]_{z=e^{j\omega}}
    \label{eq:L19_S03_1}
\end{equation}
For a real coefficient transfer function \( H(z) \) it can be showed that:
\begin{equation}
    \abs{H(e^{j\omega})}^2
    =
    H(e^{j\omega}) H^{*}(e^{j\omega})
    =
    H(e^{j\omega}) H(e^{-j\omega})
    =
    \qty[H(z)H(z^{-1})]_{z=e^{j\omega}}
    \label{eq:L19_S03_2}
\end{equation}
For a stable rational transfer function in the form:
\begin{equation}
    H(z)
    =
    \frac{p_{0}}{d_{0}} z^{(N-M)} \frac{\displaystyle \prod_{k=1}^{M} (z-\xi_{k})}{\displaystyle \prod_{k=1}^{N} (z-\lambda_{k})}
    \label{eq:L19_S04_1}
\end{equation}
the \textbf{factored form of the frequency response} is given by:\marginpar{Factored form of frequency response}
\begin{equation}
    H(e^{j\omega})
    =
    \frac{p_{0}}{d_{0}} e^{j\omega (N-M)} \frac{\displaystyle \prod_{k=1}^{M} (e^{j\omega}-\xi_{k})}{\displaystyle \prod_{k=1}^{N} (e^{j\omega}-\lambda_{k})}
    \label{eq:L19_S04_2}
\end{equation}
It is convenient to visualize the contributions of the zero \( (z-\xi_{k}) \) and the pole factor \( (z-\lambda_{k}) \) from the factored form of the frequency response. The \textbf{magnitude function} is given by:
\marginpar{Magnitude function}
\begin{equation}
    \abs{H(e^{j\omega})}
    =
    \abs{\frac{p_{0}}{d_{0}}}
    \frac{\displaystyle \prod_{k=1}^{M} \abs{e^{j\omega}-\xi_{k}}}{\displaystyle \prod_{k=1}^{N} \abs{e^{j\omega}-\lambda_{k}}}
    \label{eq:L19_S05_1}
\end{equation}
The \textbf{phase response for a rational transfer function} is of the form:
\marginpar{Phase response for a rational transfer function}
\begin{equation}
    \arg\qty{H(e^{j\omega})}
    =
    \arg{\qty(\frac{p_{0}}{d_{0}})} + \omega (N-M) + \sum_{k=1}^{M} \arg{(e^{j\omega} - \xi_{k})} - \sum_{k=1}^{N} \arg{(e^{j\omega} - \lambda_{k})}
    \label{eq:L19_S06_1}
\end{equation}
The \textbf{magnitude-squared function of a real-coefficient transfer function} can be computed using:
\marginpar{Magnitude-squared function of a real-coefficient transfer function}
\begin{equation}
    \abs{H(e^{j\omega})}^{2}
    =
    \abs{\frac{p_{0}}{d_{0}}}^{2}
    \frac{\displaystyle \prod_{k=1}^{M} (e^{j\omega}-\xi_{k})(e^{j\omega} - \xi^{*}_{k})}{\displaystyle \prod_{k=1}^{M} (e^{j\omega}-\lambda_{k})(e^{j\omega} - \lambda^{*}_{k})}
    \label{eq:L19_S07_1}
\end{equation}


\medskip
\marginpar{Geometric interpretation of frequency response}
From the factored form of the frequency response in Eq. \ref{eq:L19_S04_2} it is convenient to develop a geometric interpretation of the frequency response computation from the pole-zero plot as \( \omega \) varies from \( 0 \) to \( 2\pi \) on the unit circle.
The geometric interpretation can be used to obtain a sketch of the response as a function of the frequency. A typical factor in the factored form of the frequency response is given by \( (e^{j\omega} - \rho e^{j \varphi}) \), where \( \rho e^{j\varphi} \) is a zero, if it is zero factor, or it is a pole, if it is a pole factor.
As showed in Figure \ref{fig:L19_S10_1}, in the \( z \)-plane the factor \( (e^{j\omega} - \rho e^{j \varphi}) \) represents a vector starting at the point \( z = \rho e^{j\varphi} \) and ending on the unit circle at \( z = e^{j\omega} \).

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.3\textwidth]{\figpath{19}/19_images/S10_1.pdf}
    \caption{\label{fig:L19_S10_1} Factor \( (e^{j\omega} - \rho e^{j \varphi}) \) in the z-plane.}
\end{figure}

As \( \omega \) is varied  from \( 0 \) to \( 2\pi \), the tip of the vector moves counterclockwise from the point \( z = 1 \), tracing the unit circle, and back to the point \( z = 1 \).

As indicated by the modulus of \( H(e^{j\omega}) \), in Eq. \ref{eq:L19_S05_1}, the magnitude response \( \abs{H(e^{j\omega})} \) at a specific value of \( \omega \) is given by the product of the magnitudes of all zero vectors divided by the product of the magnitudes of all pole vectors.
Likewise, from Eq. \ref{eq:L19_S06_1}, we observe that the phase response at a specific value of \( \omega \) is obtained by adding the phase of the term \( \frac{p_{0}}{d_{0}} \) and the linear-phase term \( \omega (N-M) \) to the sum of the angles of the zero vectors minus the angles of the pole vectors.
Thus, an approximate plot of the magnitude and phase responses of the transfer function of an LTI digital filter can be developed by examining the pole and zero locations.

Now, a zero (pole) vector has the smallest magnitude when \( \omega = \varphi \). To highly attenuate signal components in a specified frequency range, we need to place zeros very close to or on the unit circle in this range.
Likewise, to highly emphasize signal components in a specified frequency range, we need to place poles very close to or on the unit circle in this range.





\section{Simple digital filters}
\marginpar{Simple digital filters}
Later in the course we shall review various methods of designing frequency-selective filters satisfying prescribed specifications. We now describe several low-order FIR and IIR digital filters with reasonable selective frequency responses that often are satisfactory in a number of applications.
FIR digital filters considered here have integer-valued impulse response coefficients. These filters are employed in a number of practical applications, primarily because of their simplicity, which makes them amenable to inexpensive hardware implementations.



\subsection{Lowpass FIR digital filters}
\marginpar{Example of lowpass FIR digital filter}
The simplest lowpass FIR digital filter is the \textbf{2-point moving-average filter} given by:
\begin{equation}
    H_{0}(z)
    =
    \frac{1}{2} (1+z^{-1})
    =
    \frac{z+1}{2z}
    \label{eq:L19_S17_1}
\end{equation}
The transfer function in Eq. \ref{eq:L19_S17_1} has a zero at \( z = -1 \) and a pole at \( z = 0 \). Note that here the pole vector has a unity magnitude for all values of \( \omega \).
On the other hand, as \( \omega \) increases from \( 0 \) to \( \pi \), the magnitude of the zero vector decreases from a value of \( 2 \), namely the diameter of the unit circle, to \( 0 \). Hence, the magnitude response \( \abs{H_{0}(e^{j\omega})} \) is a monotonically decreasing function of \( \omega \) from \( \omega = 0 \) to \( \omega = \pi \).
The maximum value of the magnitude function is \( 1 \) at \( \omega = 0 \), and the minimum value is \( 0 \) at \( \omega = \pi \), i.e.:
\begin{align}
    \abs{H_{0}(e^{j0})} &= 1    \\
    \abs{H_{0}(e^{j\pi})} &= 0
\end{align}
The frequency response of the above filter is given by:
\begin{equation}
    H_{0}(e^{j\omega})
    =
    e^{-j\frac{\omega}{2}} \cos\qty(\frac{\omega}{2})
    \label{eq:L19_S19_2}
\end{equation}
The magnitude response \( \abs{H_{0}(e^{j\omega})} = \cos\qty(\frac{\omega}{2}) \) can be seen to be a monotonically decreasing function of \( \omega \), as showed in Figure \ref{fig:L19_S20_1}.

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.5\textwidth]{\figpath{19}/19_images/S20_1.pdf}
    \caption{\label{fig:L19_S20_1} Magnitude response of the FIR lowpass filter.}
\end{figure}

The frequency \( \omega = \omega_{c} \) at which:
\begin{equation}
    \abs{H_{0}(e^{j\omega_{c}})}
    =
    \frac{1}{\sqrt{2}} H_{0}(e^{j0})
    \label{eq:L19_S21_1}
\end{equation}
is of practical interest since here the gain \( G(\omega_{c}) \) in dB is given by:
\begin{equation}
    G(\omega_{c})
    =
    20 \log_{10}\abs{H(e^{j\omega_{c}})}
    =
    20 \log_{10}\abs{H(e^{j0})} - 20\log_{10}\sqrt{2}
    \approx
    -3 \ \si{dB}
    \label{eq:L19_S21_2}
\end{equation}
since the dc gain \( G(0) = 20\log_{10}\abs{H(e^{j0})} = 0 \).

Thus, the gain \( G(\omega) \) at \( \omega = \omega_{c} \) is approximately \( 3 \ \si{dB} \) less than the gain at \( \omega = 0 \). As a result, \( \omega_{c} \) is called the \textbf{3-dB cutoff frequency}. \marginpar{3-dB cutoff frequency}To determine the value of \( \omega_{c} \), we set:
\begin{equation}
    \abs{H_{0}(e^{j\omega_{c}})}^2
    =
    \cos^2\qty(\frac{\omega_{c}}{2})
    =
    \frac{1}{2}
    \label{eq:L19_S22_1}
\end{equation}
which yields \( \omega_{c} = \frac{\pi}{2} \).

The 3-dB cutoff frequency \( \omega_{c} \) can be considered as the passband edge frequency. As a result, for the filter \( H_{0}(z) \) the passband width is approximately \( \frac{\pi}{2} \). The stopband is from \( \frac{\pi}{2} \) to \( \pi \). Note that \( H_{0}(z) \) has a zero at \( z = -1 \) or \( \omega = \pi \), which is in the stopband of the filter.

\medskip
A \textbf{cascade} of the simple FIR filter:
\marginpar{Lowpass FIR filter cascade}
\begin{equation}
    H_{0}(z)
    =
    \frac{1}{2} (1 + z^{-1})
    \label{eq:L19_S24_1}
\end{equation}
results in an improved lowpass frequency response as showed in Figure \ref{fig:L19_S24_1} for a cascade of 3 sections.

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.5\textwidth]{\figpath{19}/19_images/S24_1.pdf}
    \caption{\label{fig:L19_S24_1} Magnitude response of the FIR lowpass filter cascade.}
\end{figure}

The 3-dB cutoff frequency of a cascade of \( M \) sections is given by:
\begin{equation}
    \omega_{c}
    =
    2 \arccos\qty(2^{-\frac{1}{2M}})
    \label{eq:L19_S25_1}
\end{equation}
For \( M = 3 \), the above yields \( \omega_{c} = 0.302\pi \). Thus, the cascade of first-order sections yields a sharper magnitude response but at the expense of a decrease in the width of the passband.

A better approximation to the ideal lowpass filter is given by a higher-order moving-average filter. Signals with rapid fluctuations in sample values are generally associated with high-frequency components. These are essentially removed by a moving-average filter resulting in a smoother output waveform.



\subsection{Highpass FIR digital filters}
\marginpar{Example of highpass FIR digital filter}
The simplest highpass FIR filter is obtained from the simplest lowpass FIR filter by replacing \( z \) with \( -z \). This results in:
\begin{equation}
    H_{1}(z)
    =
    \frac{1}{2} (1-z^{-1})
    \label{eq:L19_S27_1}
\end{equation}
The corresponding frequency response is given by:
\begin{equation}
    H_{1}(e^{j\omega})
    =
    je^{-j \frac{\omega}{2}} \sin\qty(\frac{\omega}{2})
    \label{eq:L19_S28_1}
\end{equation}
whose magnitude response is showed in Figure \ref{fig:L19_S28_1}.

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.5\textwidth]{\figpath{19}/19_images/S28_1.pdf}
    \caption{\label{fig:L19_S28_1} Magnitude response of the FIR highpass filter.}
\end{figure}

The monotonically increasing behavior of the magnitude function can again be demonstrated by examining the pole-zero pattern of the transfer function \( H_{1}(z) \).
The highpass transfer function \( H_{1}(z) \) has a zero at \( z = 1 \) or \( \omega = 0 \), which is in the stopband of the filter.

Improved highpass magnitude response can be obtained by cascading several sections of the first-order highpass filter. Alternately, a \textbf{higher-order highpass filter} of the form:
\marginpar{Higher-order highpass filter}
\begin{equation}
    H_{1}(z)
    =
    \frac{1}{M} \sum_{n=0}^{M-1} (-1)^{n} z^{-n}
    \label{eq:L19_S30_1}
\end{equation}
is obtained by replacing \( z \) with \( -z \) in the transfer function of a moving average filter.

\marginpar{Application in MTI radars}
An application of the FIR highpass filters is in \textbf{moving-target-indicator (MTI) radars}. In these radars, interfering signals, called \textbf{clutters}, are generated from fixed objects in the path of the radar beam. The clutter, generated mainly from ground echoes and weather returns, has frequency components near zero frequency (dc).
The clutter can be removed by filtering the radar return signal through a two-pulse canceler, which is the first-order FIR highpass filter. For a more effective removal it may be necessary to use a \textbf{three-pulse canceler} obtained by cascading two two-pulse cancelers:
\begin{equation}
    H_{1}(z)
    =
    \frac{1}{2} (1 - z^{-1})
    \label{eq:L19_S32_1}
\end{equation}



\subsection{Lowpass IIR digital filters}
\marginpar{Example of lowpass IIR digital filter}
We have already showed that the first-order causal IIR transfer function:
\begin{equation}
    H(z)
    =
    \frac{k}{1 - \alpha z^{-1}}
    \qquad
    0 < \alpha < 1
    \label{eq:L19_S33_1}
\end{equation}
has a lowpass magnitude response for \( \alpha > 0 \).
An improved lowpass magnitude response is obtained by adding a factor \( (1+z^{-1}) \) to the numerator of the transfer function:
\begin{equation}
    H(z)
    =
    \frac{k(1+z^{-1})}{1 - \alpha z^{-1}}
    \qquad
    0 < \alpha < 1
    \label{eq:L19_S34_1}
\end{equation}
This forces the magnitude response to have a zero at \( \omega = \pi \) in the stopband of the filter. On the other hand, the first-order causal IIR transfer function:
\begin{equation}
    H(z)
    =
    \frac{k}{1 - \alpha z^{-1}}
    \qquad
    -1 < \alpha < 0
    \label{eq:L19_S35_1}
\end{equation}
has a highpass magnitude response for \( \alpha < 0 \). However, the modified transfer function obtained with the addition of a factor \( (1+z^{-1}) \) to the numerator:
\begin{equation}
    H(z)
    =
    \frac{k(1+z^{-1})}{1 - \alpha z^{-1}}
    \qquad
    -1 < \alpha < 0
    \label{eq:L19_S36_1}
\end{equation}
exhibits a lowpass magnitude response.
\marginpar{Modified first-order lowpass transfer function}The \textbf{modified first-order lowpass transfer function} for both positive and negative values of \( \alpha \) is then given by:
\begin{equation}
    H_{LP}(z)
    =
    \frac{k(1+z^{-1})}{1 - \alpha z^{-1}}
    \qquad
    0 < \abs{\alpha} < 1
    \label{eq:L19_S37_1}
\end{equation}
As \( \omega \) increases from \( 0 \) to \( \pi \), the magnitude of the zero vector decreases from a value of \( 2 \) to \( 0 \).
The maximum values of the magnitude function is \( \frac{2k}{(1-\alpha)} \) at \( \omega = 0 \) and the minimum value is \( 0 \) at \( \omega = \pi \), i.e.:
\begin{align}
    \abs{H_{LP}(e^{j0})} &= \frac{2k}{(1-\alpha)}   \\
    \abs{H_{LP}(e^{j\pi})} &= 0
\end{align}
Therefore, \( \abs{H_{LP}(e^{j\omega})} \) is a monotonically decreasing function of \( \omega \) from \( \omega = 0 \) to \( \omega = \pi \).

\medskip
For most applications, it is usual to have a dc gain of 0 dB, that is to have the maximum magnitude \( \abs{H(e^{j0})} = 1 \). To this end, we choose \( k = \frac{1-\alpha}{2} \), resulting in the \textbf{first-order IIR lowpass transfer function}:
\marginpar{First-order IIR lowpass transfer function}
\begin{equation}
    H_{LP}(z)
    =
    \frac{1-\alpha}{2} \frac{(1+z^{-1})}{1 - \alpha z^{-1}}
    \qquad
    0 < \abs{\alpha} < 1
    \label{eq:L19_S39_1}
\end{equation}
The transfer function in Eq. \ref{eq:L19_S39_1} has a zero at i.e., at \( \omega = \pi \), which is in the stopband. It has also a real pole at \( z = \alpha \).

As \( \omega \) increases from \( 0 \) to \( \pi \), the magnitude of the zero vector decreases from a value of \( 2 \) to \( 0 \), whereas, for a positive value of \( \alpha \), the magnitude of the pole vector increases from a value of \( 1 - \alpha \) to \( 1 + \alpha \).
The maximum value of the magnitude function is \( 1 \) at \( \omega = 0 \), and the minimum value is \( 0 \) at \( \omega = \pi \), i.e. \( \abs{H_{LP}(e^{j0})} = 1 \), \( \abs{H_{LP}(e^{j\pi})} = 0 \).
Therefore, \( H_{LP}(e^{j\omega}) \) is a monotonically decreasing function of \( \omega \) from \( \omega = 0 \) to \( \omega = \pi \) as indicated in Figure \ref{fig:L19_S42_1}.

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.9\textwidth]{\figpath{19}/19_images/S42_1.pdf}
    \caption{\label{fig:L19_S42_1} Magnitude (left) and gain (right) responses of the IIR lowpass filter.}
\end{figure}

The squared magnitude function is given by:
\begin{equation}
    \abs{H_{LP}(e^{j\omega})}^{2}
    =
    \frac{(1-\alpha)^{2}(1 + \cos\omega)}{2(1 + \alpha^{2} - 2\alpha\cos\omega)}
    \label{eq:L19_S43_1}
\end{equation}
The derivative of \( \abs{H_{LP}(e^{j\omega})}^{2} \) with respect to \( \omega \) is given by:
\begin{equation}
    \dv{\abs{H_{LP}(e^{j\omega})}^{2}}{\omega}
    =
    \frac{-(1-\alpha)^{2} (1 + \alpha^{2} + 2\alpha) \sin\omega}{2(1 + \alpha^{2} - 2\alpha\cos\omega)^{2}}
    \label{eq:L19_S43_2}
\end{equation}
The derivative in Eq. \ref{eq:L19_S43_2} is less or equal than zero in the range \( 0 \le \omega \le \pi \), verifying again the monotonically decreasing behaviour of the magnitude function. To determine the \textbf{3-dB cutoff frequency} we set:
\marginpar{3-dB cutoff frequency}
\begin{equation}
    \abs{H_{LP}(e^{j\omega})}^{2}
    =
    \frac{1}{2}
    \label{eq:L19_S44_1}
\end{equation}
in the expression for the square magnitude function, resulting in:
\begin{equation}
    \frac{(1 - \alpha)^{2}(1 + \cos\omega_{c})}{2(1 + \alpha^{2} - 2\alpha\cos\omega_{c})}
    =
    \frac{1}{2}
    \label{eq:L19_S44_2}
\end{equation}
which, when solved, yields:
\begin{equation}
    \cos\omega_{c}
    =
    \frac{2\alpha}{1 + \alpha^{2}}
    \label{eq:L19_S45_1}
\end{equation}
The above quadratic equation can be solved for \( \alpha \) yielding two solutions. The one resulting in a stable transfer function \( H_{LP}(z) \) is given by:
\begin{equation}
    \alpha
    =
    \frac{1 - \sin\omega_{c}}{\cos\omega_{c}}
    \label{eq:L19_S46_1}
\end{equation}
It follows from:
\begin{equation}
    \abs{H_{LP}(e^{j\omega})}^{2}
    =
    \frac{(1-\alpha)^{2}(1 + \cos\omega_{c})}{2(1 + \alpha^{2} - 2\alpha\cos\omega_{c})}
    \label{eq:L19_S46_2}
\end{equation}
that \( H_{LP}(z) \) is a BR function for \( \abs{\alpha} < 1 \).



\subsection{Highpass IIR digital filters}
\marginpar{Example of highpass IIR digital filter}
A \textbf{first-order causal highpass IIR digital filter} has a transfer function given by:
\begin{equation}
    H_{HP}(z)
    =
    \frac{1 + \alpha}{2} \frac{1 - z^{-1}}{1 - \alpha z^{-1}}
    \label{eq:L19_S47_1}
\end{equation}
where \( \abs{\alpha} < 1 \) in order to have stability. The transfer function in Eq. \ref{eq:L19_S47_1} has a zero at \( z = 1 \), i.e. at \( \omega = 0 \), which is in the stopband.

Its \textbf{3-dB cutoff frequency} \( \omega_{c} \) is given by:
\marginpar{3-dB cutoff frequency}
\begin{equation}
    \alpha
    =
    \frac{1 - \sin\omega_{c}}{\cos\omega_{c}}
    \label{eq:L19_S48_1}
\end{equation}
which is the same as that of \( H_{LP}(z) \). Magnitude and gain responses of \( H_{HP}(z) \) are showed in Figure \ref{fig:L19_S48_1}. \( H_{HP}(z) \) is a BR function for \( \abs{\alpha} < 1 \).

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.9\textwidth]{\figpath{19}/19_images/S48_1.pdf}
    \caption{\label{fig:L19_S48_1} Magnitude (left) and gain (right) responses of the IIR highpass filter.}
\end{figure}

\begin{example}{Design of a filter}{}
    \marginnote{\flushleft\textsl{\small Example of filter design}}
    We design a first-order highpass digital filter with a 3-dB cutoff frequency of \( 0.8\pi \).
    Now, we consider that:
    \begin{align*}
        \sin(\omega_{c}) &= \sin(0.8\pi) =  0.587785 \\
        \cos(\omega_{c}) &= \cos(0.8\pi) = -0.80902
    \end{align*}
    Therefore:
    \begin{equation}
        \alpha
        =
        \frac{1 - \sin\omega_{c}}{\cos\omega_{c}}
        =
        -0.5095245
        \label{eq:L19_S49_1}
    \end{equation}
    Therefore:
    \begin{equation}
        H_{HP}(z)
        =
        \frac{1+\alpha}{2} \frac{1 - z^{-1}}{1 - \alpha z^{-1}}
        =
        0.245238 \qty(\frac{1 - z^{-1}}{1 + 0.5095245z^{-1}})
        \label{eq:L19_S49_2}
    \end{equation}
\end{example}



\subsection{Bandpass IIR digital filters}
\marginpar{Example of bandpass IIR digital filter}
A \textbf{second-order bandpass digital transfer function} is given by:
\begin{equation}
    H_{HP}(z)
    =
    \frac{1 - \alpha}{2} \qty(\frac{1 - z^{-2}}{1 - \beta (1 + \alpha) z^{-1} + \alpha z^{-2}})
    \label{eq:L19_S50_1}
\end{equation}
Its squared magnitude function is:
\begin{equation}
    \abs{H_{BP}(e^{j\omega})}^{2}
    =
    \frac{(1 - \alpha)^{2} (1 - \cos(2\omega))}{2\qty[1 + \beta^{2}(1 + \alpha)^{2} + \alpha^{2} - 2\beta (1 + \alpha)^{2} \cos\omega + 2\alpha\cos(2\alpha)]}
    \label{eq:L19_S50_2}
\end{equation}
\( \abs{H_{BP}(e^{j\omega})}^{2} \) goes to zero at \( \omega = 0 \) and \( \omega = \pi \). It assumes a maximum value of \( 1 \) at \( \omega = \omega_{0} \), called the \textbf{center frequency of the bandpass filter}, \marginpar{Center frequency of the bandpass filter}where:
\begin{equation}
    \omega_{0}
    =
    \cos^{-1}(\beta)
    \label{eq:L19_S51_1}
\end{equation}
The frequencies \( \omega_{c_{1}} \) and \( \omega_{c_{2}} \) where \( \abs{H_{BP}(e^{j\omega})}^{2} \) becomes \( \frac{1}{2} \) are called the \textbf{3-dB cutoff frequencies}.\marginpar{3-dB cutoff frequencies and 3-dB bandwidth}
The difference between the two cutoff frequencies, assuming \( \omega_{c_{2}} > \omega_{c_{1}} \) is called the \textbf{3-dB bandwidth} and is given by:
\begin{equation}
    B_{w}
    =
    \omega_{c_{2}} - \omega_{c_{1}}
    =
    \cos^{-1}\qty(\frac{2\alpha}{1 + \alpha^{2}})
    \label{eq:L19_S52_1}
\end{equation}
The transfer function \( H_{BP}(e^{j\omega}) \) is a BR function if \( \abs{\alpha} < 1 \) and \( \abs{\beta} < 1 \). Some plots of \( \abs{H_{BP}(e^{j\omega})} \) are showed in Figure \ref{fig:L19_S53_1}.

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.9\textwidth]{\figpath{19}/19_images/S53_1.pdf}
    \caption{\label{fig:L19_S53_1} Magnitude responses of the IIR bandpass filter.}
\end{figure}

\begin{example}{Design of a filter}{}
    \marginnote{\flushleft\textsl{\small Example of filter design}}
    We design a second-order bandpass digital filter with center frequency at \( 0.4\pi \) and a 3-dB bandwidth of \( 0.1\pi \). We have:
    \begin{equation}
        \beta
        =
        \cos(\omega_{0})
        =
        \cos(0.4\pi)
        =
        0.309017
        \label{eq:L19_S54_1}
    \end{equation}
    and:
    \begin{equation}
        \frac{2\alpha}{1 + \alpha^{2}}
        =
        \cos(B_{w})
        =
        \cos(0.1\pi)
        =
        0.9510565
        \label{eq:L19_S54_2}
    \end{equation}
    The solution of Eq. \ref{eq:L19_S54_2} yields \( \alpha = 1.376382 \) and \( \alpha = 0.72654253 \). The corresponding transfer functions are:
    \begin{align}
        H_{BP}'(z)
        &=
            -0.18819 \frac{1 - z^{-2}}{1 - 0.7343424 z^{-1} + 1.37638    z^{-2}}   \\
        H_{BP}''(z)
        &=
            0.13673  \frac{1 - z^{-2}}{1 - 0.533531  z^{-1} + 0.72654253 z^{-2}}
    \end{align}
    The poles of \( H_{BP}'(z) \) are at \( z = 0.3671712 \pm j1.11425636 \) and they have a magnitude greater than \( 1 \).
    Thus, the poles of \( H_{BP}'(z) \) are outside the unit circle making the transfer function unstable.
    On the other hand, the poles of \( H_{BP}''(z) \) are at \( z = 0.2667655 \pm j0.8095546 \) and they have a magnitude of \( 0.8523746 \).
    Hence, \( H_{BP}''(z) \) is BIBO stable.

    Below, the plots of the magnitude function and the group delay of \( H_{BP}''(z) \) are showed.

    \begin{center}
        \includegraphics[width=0.75\textwidth]{\figpath{19}/19_images/S57_1.pdf}
    \end{center}
\end{example}



\subsection{Bandstop IIR digital filters}
\marginpar{Example of bandstop IIR digital filter}
A \textbf{second-order bandstop digital fiter} has a transfer function given by:
\begin{equation}
    H_{BS}(z)
    =
    \frac{1 + \alpha}{2} \qty(\frac{1 - 2\beta z^{-1} + z^{-2}}{1 - \beta (1 + \alpha) z^{-1} + \alpha z^{-2}})
    \label{eq:L19_S58_1}
\end{equation}
The transfer function \( H_{BS}(z) \) is a BR function if \( \abs{\alpha} < 1 \) and \( \abs{\beta} < 1 \). Its magnitude response is showed in Figure \ref{fig:L19_S59_1}.

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.9\textwidth]{\figpath{19}/19_images/S59_1.pdf}
    \caption{\label{fig:L19_S59_1} Magnitude responses of the IIR bandstop filter.}
\end{figure}

Here, the magnitude function takes the maximum value of \( 1 \) at \( \omega = 0 \) and \( \omega = \pi \). It goes to \( 0 \) at \( \omega = \omega_{0} \), where \( \omega_{0} \), called the \textbf{notch frequency}, is given by:\marginpar{Notch frequency and notch filters}
\begin{equation}
    \omega_{0}
    =
    \cos^{-1}(\beta)
    \label{eq:L19_S60_1}
\end{equation}
The digital transfer function \( H_{BS}(z) \) is more commonly called a \textbf{notch filter}.

The frequencies \( \omega_{c_{1}} \) and \( \omega_{c_{2}} \) where \( \abs{H_{BP}(e^{j\omega})}^{2} \) becomes \( \frac{1}{2} \) are called the \textbf{3-dB cutoff frequencies}.\marginpar{3-dB cutoff frequencies and 3-dB notch bandwidth}
The difference between them, assuming \( \omega_{c_{2}} > \omega_{c_{1}} \), is called the \textbf{3-dB notch bandwidth} and it is given by:
\begin{equation}
    B_{w}
    =
    \omega_{c_{2}} - \omega_{c_{1}}
    =
    \cos^{-1}\qty(\frac{2\alpha}{1 + \alpha^{2}})
    \label{eq:L19_S61_1}
\end{equation}



\subsection{Higher-Order IIR digital filters}
\marginpar{Example of higher-order IIR digital filter}
By cascading the simple digital filters discussed so far, we can implement digital filters with sharper magnitude responses. For example, let us consider a cascade of \( k \) first-order lowpass sections characterized by the transfer function:
\begin{equation}
    H_{LP}(z)
    =
    \frac{1 - \alpha}{2} \frac{1 + z^{-1}}{1 - \alpha z^{-1}}
    \label{eq:L19_S62_1}
\end{equation}
The overall structure has a transfer function given by:
\begin{equation}
    G_{LP}(z)
    =
    \qty(\frac{1 - \alpha}{2} \cdot \frac{1 + z^{-1}}{1 - \alpha z^{-1}})^{k}
    \label{eq:L19_S63_1}
\end{equation}
The corresponding squared-magnitude function is given by:
\begin{equation}
    \abs{G_{LP}(e^{j\omega})}^{2}
    =
    \qty[\frac{(1 - \alpha)^{2} (1 + \cos\omega)}{2(1 + \alpha^{2} - 2\alpha\cos\omega)}]^{k}
    \label{eq:L19_S63_2}
\end{equation}
To determine the relation between its 3-dB cutoff frequency \( \omega_{c} \) and the parameter \( \alpha \), we set:
\begin{equation}
    \qty[\frac{(1 - \alpha)^{2} (1 + \cos\omega)}{2(1 + \alpha^{2} - 2\alpha\cos\omega)}]^{k}
    =
    \frac{1}{2}
    \label{eq:L19_S64_1}
\end{equation}
which when solved for \( \alpha \), yields for a stable \( G_{LP}(z) \):
\begin{equation}
    \alpha
    =
    \frac{1 + (1-C) \cos\omega_{c} - \sin\omega_{c} \sqrt{2C - C^{2}}}{1 - C + \cos\omega_{c}}
    \label{eq:L19_S64_2}
\end{equation}
where:
\begin{equation}
    C
    =
    2^{\frac{k - 1}{k}}
    \label{eq:L19_S65_1}
\end{equation}
It should be noted that, for \( k = 1 \), the expression given in Eq. \ref{eq:L19_S64_2} reduces to:
\begin{equation}
    \alpha
    =
    \frac{1 - \sin\omega_{c}}{\cos\omega_{c}}
    \label{eq:L19_S65_2}
\end{equation}

\begin{example}{Design of a filter}{}
    \marginnote{\flushleft\textsl{\small Example of filter design}}
    We design a lowpass filter with a 3-dB cutoff frequency at \( \omega_{c} = 0.4\pi \) using a single first-order section and a cascade of 4 first-order sections, and we compare their gain responses.

    For the single first-order lowpass filter we have:
    \begin{equation}
        \alpha
        =
        \frac{1 + \sin\omega_{c}}{\cos\omega_{c}}
        =
        \frac{1 + \sin(0.4\pi)}{\cos(0.4\pi)}
        \label{eq:L19_S66_1}
    \end{equation}
    For the cascade of 4 first-order sections, we substitute \( k = 4 \) and get:
    \begin{equation}
        C
        =
        2^{\frac{k-1}{k}}
        =
        2^{\frac{4-1}{4}}
        =
        1.6818
        \label{eq:L19_S67_1}
    \end{equation}
    Next, we compute:
    \begin{align}
        \alpha
        &=
            \frac{1 + (1-C) \cos\omega_{c} - \sin\omega_{c} \sqrt{2C - C^{2}}}{1 - C + \cos\omega_{c}}  \nonumber   \\
        &=
            \frac{1 + (1-1.6818) \cos(0.4\pi) - \sin(0.4\pi) \sqrt{2(1.6818) - (1.6818)^{2}}}{1 - 1.6818 + \cos(0.4\pi)}    \nonumber   \\
        &=
            -0.251
    \end{align}
    The gain responses of the two filters are showed in the plots below. A can be seen, cascading has resulted in a sharper roll-off in the gain response

    \begin{center}
        \includegraphics[width=0.9\textwidth]{\figpath{19}/19_images/S68_1.pdf}
    \end{center}
\end{example}

\end{document}
